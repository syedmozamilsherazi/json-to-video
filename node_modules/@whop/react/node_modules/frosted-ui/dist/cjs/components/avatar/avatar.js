"use strict";
'use client';
Object.defineProperty(exports, "__esModule", { value: true });
exports.Avatar = void 0;
const tslib_1 = require("tslib");
const classnames_1 = tslib_1.__importDefault(require("classnames"));
const React = tslib_1.__importStar(require("react"));
const AvatarPrimitive = tslib_1.__importStar(require("../../forked-primitives/avatar"));
const avatar_props_1 = require("./avatar.props");
const get_initials_1 = require("../../helpers/get-initials");
const Avatar = (props) => {
    const { className, style, size = avatar_props_1.avatarPropDefs.size.default, color = avatar_props_1.avatarPropDefs.color.default, highContrast = avatar_props_1.avatarPropDefs.highContrast.default, fallback: fallbackProp, variant = avatar_props_1.avatarPropDefs.variant.default, ...imageProps } = props;
    const [status, setStatus] = React.useState('idle');
    const dataStatus = imageProps.src ? status : 'idle';
    const fallback = React.useMemo(() => {
        if (typeof fallbackProp !== 'string')
            return fallbackProp;
        try {
            return (0, get_initials_1.getInitials)(fallbackProp);
        }
        catch (error) {
            console.error('Error generating initials:', error);
            return fallbackProp;
        }
    }, [fallbackProp]);
    return (React.createElement(AvatarPrimitive.Root, { "data-accent-color": color, "data-status": dataStatus, className: (0, classnames_1.default)('fui-AvatarRoot', className, `fui-r-size-${size}`, { 'fui-high-contrast': highContrast }, `fui-variant-${variant}`), style: style },
        status === 'idle' || status === 'loading' ? React.createElement("span", { className: "fui-AvatarFallback" }) : null,
        status === 'error' ? (React.createElement(AvatarPrimitive.Fallback, { className: (0, classnames_1.default)('fui-AvatarFallback', {
                'fui-one-letter': typeof fallback === 'string' && fallback.length === 1,
                'fui-two-letters': typeof fallback === 'string' && fallback.length === 2,
            }), delayMs: 0 }, fallback)) : null,
        React.createElement(AvatarPrimitive.Image, { className: "fui-AvatarImage", ...imageProps, onLoadingStatusChange: (status) => {
                var _a;
                (_a = imageProps.onLoadingStatusChange) === null || _a === void 0 ? void 0 : _a.call(imageProps, status);
                setStatus(status);
            } })));
};
exports.Avatar = Avatar;
Avatar.displayName = 'Avatar';
//# sourceMappingURL=avatar.js.map