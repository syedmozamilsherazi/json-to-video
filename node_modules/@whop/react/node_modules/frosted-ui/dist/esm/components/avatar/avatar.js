'use client';
import classNames from 'classnames';
import * as React from 'react';
import * as AvatarPrimitive from '../../forked-primitives/avatar';
import { avatarPropDefs } from './avatar.props';
import { getInitials } from '../../helpers/get-initials';
const Avatar = (props) => {
    const { className, style, size = avatarPropDefs.size.default, color = avatarPropDefs.color.default, highContrast = avatarPropDefs.highContrast.default, fallback: fallbackProp, variant = avatarPropDefs.variant.default, ...imageProps } = props;
    const [status, setStatus] = React.useState('idle');
    const dataStatus = imageProps.src ? status : 'idle';
    const fallback = React.useMemo(() => {
        if (typeof fallbackProp !== 'string')
            return fallbackProp;
        try {
            return getInitials(fallbackProp);
        }
        catch (error) {
            console.error('Error generating initials:', error);
            return fallbackProp;
        }
    }, [fallbackProp]);
    return (React.createElement(AvatarPrimitive.Root, { "data-accent-color": color, "data-status": dataStatus, className: classNames('fui-AvatarRoot', className, `fui-r-size-${size}`, { 'fui-high-contrast': highContrast }, `fui-variant-${variant}`), style: style },
        status === 'idle' || status === 'loading' ? React.createElement("span", { className: "fui-AvatarFallback" }) : null,
        status === 'error' ? (React.createElement(AvatarPrimitive.Fallback, { className: classNames('fui-AvatarFallback', {
                'fui-one-letter': typeof fallback === 'string' && fallback.length === 1,
                'fui-two-letters': typeof fallback === 'string' && fallback.length === 2,
            }), delayMs: 0 }, fallback)) : null,
        React.createElement(AvatarPrimitive.Image, { className: "fui-AvatarImage", ...imageProps, onLoadingStatusChange: (status) => {
                var _a;
                (_a = imageProps.onLoadingStatusChange) === null || _a === void 0 ? void 0 : _a.call(imageProps, status);
                setStatus(status);
            } })));
};
Avatar.displayName = 'Avatar';
export { Avatar };
//# sourceMappingURL=avatar.js.map